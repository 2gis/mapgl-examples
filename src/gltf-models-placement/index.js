(()=>{"use strict";var e={9958:e=>{var t,o,n=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function r(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(o){try{return t.call(null,e,0)}catch(o){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{o="function"==typeof clearTimeout?clearTimeout:a}catch(e){o=a}}();var l,s=[],d=!1,u=-1;function c(){d&&l&&(d=!1,l.length?s=l.concat(s):u=-1,s.length&&m())}function m(){if(!d){var e=r(c);d=!0;for(var t=s.length;t;){for(l=s,s=[];++u<t;)l&&l[u].run();u=-1,t=s.length}l=null,d=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function v(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];s.push(new p(e,t)),1!==s.length||d||r(m)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=v,n.addListener=v,n.once=v,n.off=v,n.removeListener=v,n.removeAllListeners=v,n.emit=v,n.prependListener=v,n.prependOnceListener=v,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},3587:e=>{e.exports=n,e.exports.parse=n,e.exports.stringify=function e(t){"Feature"===t.type&&(t=t.geometry);function o(e){return e.join(" ")}function n(e){return e.map(o).join(", ")}function i(e){return e.map(n).map(a).join(", ")}function a(e){return"("+e+")"}switch(t.type){case"Point":return"POINT ("+o(t.coordinates)+")";case"LineString":return"LINESTRING ("+n(t.coordinates)+")";case"Polygon":return"POLYGON ("+i(t.coordinates)+")";case"MultiPoint":return"MULTIPOINT ("+n(t.coordinates)+")";case"MultiPolygon":return"MULTIPOLYGON ("+(t.coordinates.map(i).map(a).join(", ")+")");case"MultiLineString":return"MULTILINESTRING ("+i(t.coordinates)+")";case"GeometryCollection":return"GEOMETRYCOLLECTION ("+t.geometries.map(e).join(", ")+")";default:throw new Error("stringify requires a valid GeoJSON Feature or geometry object as input")}};var t=/[-+]?([0-9]*\.[0-9]+|[0-9]+)([eE][-+]?[0-9]+)?/,o=new RegExp("^"+t.source+"(\\s"+t.source+"){1,}");function n(e){var t,n=e.split(";"),i=n.pop(),a=(n.shift()||"").split("=").pop(),r=0;function l(e){var t=i.substring(r).match(e);return t?(r+=t[0].length,t[0]):null}function s(){l(/^\s*/)}function d(){s();for(var e,t=0,n=[],i=[n],a=n;e=l(/^(\()/)||l(/^(\))/)||l(/^(,)/)||l(o);){if("("===e)i.push(a),a=[],i[i.length-1].push(a),t++;else if(")"===e){if(0===a.length)return null;if(!(a=i.pop()))return null;if(0===--t)break}else if(","===e)a=[],i[i.length-1].push(a);else{if(e.split(/\s/g).some(isNaN))return null;Array.prototype.push.apply(a,e.split(/\s/g).map(parseFloat))}s()}return 0!==t?null:n}function u(){for(var e,t,n=[];t=l(o)||l(/^(,)/);)","===t?(n.push(e),e=[]):t.split(/\s/g).some(isNaN)||(e||(e=[]),Array.prototype.push.apply(e,t.split(/\s/g).map(parseFloat))),s();return e?(n.push(e),n.length?n:null):null}function c(){return function(){if(!l(/^(point(\sz)?)/i))return null;if(s(),!l(/^(\()/))return null;var e=u();return e?(s(),l(/^(\))/)?{type:"Point",coordinates:e[0]}:null):null}()||function(){if(!l(/^(linestring(\sz)?)/i))return null;if(s(),!l(/^(\()/))return null;var e=u();return e&&l(/^(\))/)?{type:"LineString",coordinates:e}:null}()||function(){if(!l(/^(polygon(\sz)?)/i))return null;s();var e=d();return e?{type:"Polygon",coordinates:e}:null}()||function(){if(!l(/^(multipoint)/i))return null;s();var e=i.substring(i.indexOf("(")+1,i.length-1).replace(/\(/g,"").replace(/\)/g,"");i="MULTIPOINT ("+e+")";var t=d();return t?(s(),{type:"MultiPoint",coordinates:t}):null}()||function(){if(!l(/^(multilinestring)/i))return null;s();var e=d();return e?(s(),{type:"MultiLineString",coordinates:e}):null}()||function(){if(!l(/^(multipolygon)/i))return null;s();var e=d();return e?{type:"MultiPolygon",coordinates:e}:null}()||function(){var e,t=[];if(!l(/^(geometrycollection)/i))return null;if(s(),!l(/^(\()/))return null;for(;e=c();)t.push(e),s(),l(/^(,)/),s();return l(/^(\))/)?{type:"GeometryCollection",geometries:t}:null}()}return(t=c())&&a.match(/\d+/)&&(t.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+a}}),t}}},t={};function o(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,o),a.exports}(()=>{function e(e,t,o,n){return new(o||(o=Promise))((function(i,a){function r(e){try{s(n.next(e))}catch(e){a(e)}}function l(e){try{s(n.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,l)}s((n=n.apply(e,t||[])).next())}))}Object.create;Object.create;let t="undefined"!=typeof Float64Array?Float64Array:Array;Math.random;Math.PI;function n(){let e=new t(2);return e[0]=0,e[1]=0,e}function i(e,o){let n=new t(2);return n[0]=e,n[1]=o,n}!function(){let e=n()}();function a(){let e=new t(3);return e[0]=0,e[1]=0,e[2]=0,e}function r(e,t){let o=t[0],n=t[1],i=t[2],a=o*o+n*n+i*i;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e}!function(){let e=a()}();function l(){let e=new t(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}!function(){let e=l()}();function s(e,t,o){return e[0]=o[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=o[2],e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}const d=Math.pow(2,32);Math.pow(2,20),Math.pow(2,15),Math.pow(2,16);var u=o(9958);u.env.TEST&&location.origin,u.env.TEST&&location.origin,[2,5,25].map((e=>1e3*e));const c={fov:60*Math.PI/180,useDynamicNearFar:!1,near:1e3,far:Math.pow(2,34),viewportLimitRatio:2.1,minTrapezeHeight:262144,perspectiveDistanceLimitRatio:10,minFogDistance:2e4,pitchInterStartZoom:17,pitchInterEndZoom:19};a();function m(e,t,o){return e=Math.max(e,t),e=Math.min(e,o)}function p(e){return e*Math.PI/180}function v(e){return e/Math.PI*180}function h(e,t){return{min:e||i(1/0,1/0),max:t||i(-1/0,-1/0)}}const f=6378137,g=2*Math.PI*f,y=d/g;s([],[-1,-1,0],[2,2,1]),s([],[.5,.5,0],[.5,.5,1]),Math.PI,Math.pow(2,15);function b(e){return Math.max(e,1e3)}h([-d/2,-d/2],[d/2,d/2]),h([-100*d/2,-d/2],[100*d/2,d/2]);n(),n();const S=l();class k{constructor(e,t){this.state=e,this.camera=t,this.position=[0,0,0]}static fromGeo(e,t=[0,0]){var o;const n=d/2,i=Math.sin(p(e[1])),a=e[0]*d/360,r=Math.log((1+i)/(1-i))*d/(4*Math.PI);let l=0;if(e.length>2){const t=k.scaleFactor(e[1]);l=(null!==(o=e[2])&&void 0!==o?o:0)*y*t}return t[0]=a,t[1]=m(r,-n,n),t[2]=l,t}static toGeo(e,t=[0,0]){t[0]=360*e[0]/d;const o=-2*Math.PI/d;if(t[1]=90-2*v(Math.atan(Math.exp(e[1]*o))),e[2]){const o=k.scaleFactor(t[1]);t[2]=e[2]/y/o}return t}static scaleFactor(e){return 1/Math.cos(p(e))}update(){const{center:e,rotation:t,zoom:o,pitch:n,size:i}=this.state,a=function(e,t){const o=c;return b(t[1])/2/256*(d/Math.pow(2,e))/Math.tan(o.fov/2)}(o,i),r=Math.max(a*Math.sin(n),1);this.position[0]=e[0]+Math.sin(t)*r,this.position[1]=e[1]-Math.cos(t)*r,this.position[2]=a*Math.cos(n)}project(e,t=!1,o=[NaN,NaN]){const{size:n,viewport:i}=this.state;S[0]=e[0],S[1]=e[1],S[2]=e[2],S[3]=1,function(e,t,o){let n=t[0],i=t[1],a=t[2],r=t[3];e[0]=o[0]*n+o[4]*i+o[8]*a+o[12]*r,e[1]=o[1]*n+o[5]*i+o[9]*a+o[13]*r,e[2]=o[2]*n+o[6]*i+o[10]*a+o[14]*r,e[3]=o[3]*n+o[7]*i+o[11]*a+o[15]*r}(S,S,this.camera.viewProjectionMatrix);const[a,r,l,s]=S,d=2*s;if(t&&(l>d||l<-d||a>d||a<-d||r>d||r<-d))return o;const u=n[0]/2,c=n[1]/2;return o[0]=u+i.left+a*u/s,o[1]=c+i.top-r*c/s,o}unproject(e,t=[0,0,0]){const{size:o,viewport:n}=this.state;t[0]=(e[0]-n.left)/o[0]*2-1,t[1]=-(Math.max(this.camera.horizonPixelOffset,e[1])-n.top)/o[1]*2+1,t[2]=0,function(e,t,o){let n=t[0],i=t[1],a=t[2],r=o[3]*n+o[7]*i+o[11]*a+o[15];r=r||1,e[0]=(o[0]*n+o[4]*i+o[8]*a+o[12])/r,e[1]=(o[1]*n+o[5]*i+o[9]*a+o[13])/r,e[2]=(o[2]*n+o[6]*i+o[10]*a+o[14])/r}(t,t,this.camera.viewProjectionMatrixInverse),t[0]-=this.position[0],t[1]-=this.position[1],t[2]-=this.position[2],r(t,t);const i=-this.position[2]/t[2];return t[0]=this.position[0]+t[0]*i,t[1]=this.position[1]+t[1]*i,t[2]=this.position[2]+t[2]*i,t}setState(e){this.state=e}}l();const L={modelLocationInfo:{ru:"Для того, чтобы найти добавленную модель на карте, попробуйте подобрать подходящий масштаб, используя контролы зума или колесо мыши, а также нажать на элемент добавленной модели в панели инструментов для выставления центра карты",en:"To locate the added model on the map, try adjusting the appropriate scale using the zoom controls or the mouse wheel, and also click on the item in the added model list in the toolbar to center the map"},addModel:{ru:"Добавить модель",en:"Add model"},getSceneConfig:{ru:"Получить конфиг сцены",en:"Get scene config"},zoomRange:{ru:"Масштаб",en:"Scale"},pitchRange:{ru:"Наклон",en:"Pitch"},rotationRange:{ru:"Поворот",en:"Rotation"},modelParamCoords:{ru:"Координаты",en:"Coordinates"},modelParamCoordsInfo:{ru:"для перемещения модели используйте стрелки или ЛКМ и движение мышью",en:"to move the model, use the arrow keys or the left mouse button and mouse movement"},modelParamLng:{ru:"Долгота",en:"Longitude"},modelParamLat:{ru:"Широта",en:"Latitude"},modelParamLinkedObjects:{ru:"Связанные объекты",en:"Linked objects"},modelParamLinkedObjectsInfo:{ru:"для выбора скрытых зданий моделью кликайте на них ЛКМ",en:"to select buildings hidden by the model, click on them with the left mouse button"},modelParamLinkedIds:{ru:"ID зданий",en:"Building IDs"},modelPlayAnimationIndex:{ru:"Индекс анимации",en:"Animation index"},modelParamPlayAnimation:{ru:"Воспроизвести анимацию",en:"Play animation"},modelParamRotation:{ru:"Поворот",en:"Rotation"},modelParamRotationInfo:{ru:"для поворота модели зажмите клавишу R, затем ЛКМ и подвигайте мышью",en:"to rotate the model, hold down the R key, then the left mouse button, and move the mouse"},modelParamScale:{ru:"Масштаб",en:"Scale"},modelParamScaleInfo:{ru:"для масштабирования модели зажмите клавишу S, затем ЛКМ и подвигайте мышью",en:"to scale the model, hold down the S key, then the left mouse button, and move the mouse"},modelParamAnimationInfo:{ru:"для запуска анимации модели введите индекс анимации",en:"to start the model animation, enter the animation index"},pageLeaveMsg:{ru:"Вы уверены, что хотите покинуть страницу?",en:"Are you sure you want to leave the page?"},removeModelMsg:{ru:"Вы уверены, что хотите удалить модель?",en:"Are you sure you want to remove the model?"}};function w(t){return e(this,void 0,void 0,(function*(){const e=(new TextEncoder).encode(t),o=yield crypto.subtle.digest("SHA-1",e);return Array.from(new Uint8Array(o)).map((e=>e.toString(16).padStart(2,"0"))).join("")}))}function x(e){const t=e[0],o=e[1];return Math.sqrt(t*t+o*o)}o(3587);P();const M={center:[82.920412,55.030111],zoom:11,minZoom:1,autoHideOSMCopyright:!0,key:"a1893935-6834-4445-b97a-3405fb426c5b",trafficControl:!0,floorControl:!0,metroControl:!0,viewport:{top:10,bottom:15,right:15,left:10},mobileSdkMode:!1,disableIconCache:!1,disableHoverStyles:!0,disableRotationByUserInteraction:!1,disablePitchByUserInteraction:!1,keepCenterWhileUserZoomRotate:!1,preserveDrawingBuffer:!1,tileServer:"tile{subdomain}-sdk.maps.2gis.com",enableTrackResize:!0,showDefaultTileBounds:!1,scaleControl:"bottomCenter",bssUrl:"https://casino-bss-receiver-api-qa.web-staging.2gis.ru/bss/3",maxPitch:70,maxZoom:22,lowZoomMaxPitch:45,pitchHightLimitation:90,webglVersion:2,disableAntiAliasing:!1,loopWorld:!0,trafficMinZoom:9,trafficMaxZoom:16,trafficMaxDetailLevel:17,modelShowHideEventsSublayers:["Animated_immersive_model","Immersive_model","Immersive_model_multipart","Commercial_model"],graphicsPreset:"immersive"};!function(e){var t,o;const n=P();void 0!==n.lng&&void 0!==n.lat&&(e.center=[parseFloat(n.lng),parseFloat(n.lat)]);void 0!==n.zoom&&(e.zoom=parseFloat(n.zoom));void 0!==n.styleZoom&&(e.styleZoom=parseFloat(n.styleZoom));void 0!==n.rotation&&(e.rotation=parseFloat(n.rotation));void 0!==n.touchRotationThreshold&&(e.touchRotationThreshold=parseFloat(n.touchRotationThreshold));void 0!==n.key&&(e.key=n.key);void 0!==n.pitch&&(e.pitch=parseFloat(n.pitch));void 0!==n.styleId&&(e.style=n.styleId);void 0!==n.dracoDecoderUrl&&(e.dracoDecoderUrl=decodeURIComponent(n.dracoDecoderUrl));void 0!==n.keyUrl&&(e.keyUrl=decodeURIComponent(n.keyUrl));void 0!==n.styleServer&&(e.styleServer=decodeURIComponent(n.styleServer));void 0!==n.fontUrl&&(e.fontUrl=decodeURIComponent(n.fontUrl));void 0!==n.iconUrl&&(e.iconUrl=decodeURIComponent(n.iconUrl));void 0!==n.modelUrl&&(e.modelUrl=decodeURIComponent(n.modelUrl));void 0!==n.tileServer&&(e.tileServer=decodeURIComponent(n.tileServer));void 0!==n.modelsTilesUrl&&(e.modelsTilesUrl=decodeURIComponent(n.modelsTilesUrl));void 0!==n.defaultSourceModelsRootUrl&&(e.defaultSourceModelsRootUrl=decodeURIComponent(n.defaultSourceModelsRootUrl));"westeros"in n&&(e.westeros=!0);void 0!==n.tileProtocol&&(e.tileProtocol=n.tileProtocol);void 0!==n.tileSet&&(e.tileSet=n.tileSet);void 0!==n.modelsTileSet&&(e.modelsTileSet=n.modelsTileSet);"comPoiSeed"in n&&!Number.isNaN(parseFloat(null!==(t=n.comPoiSeed)&&void 0!==t?t:""))&&(e.commercialPoiRandomSeed=Number(n.comPoiSeed));"reliefScale"in n&&(e.reliefScale=Number(n.reliefScale));"mobileSdkMode"in n&&(e.mobileSdkMode=!0);void 0!==n.nearCameraFade&&(e.nearCameraFade=n.nearCameraFade.split(",").map(Number));e.rampPreset=n.rampPreset,e.shading=Number(n.shading),void 0!==n.commercialTileSet&&(e.commercialTileSet=n.commercialTileSet);void 0!==n.defaultBackgroundColor&&(e.defaultBackgroundColor="#"+n.defaultBackgroundColor);void 0!==n.trafficProtocol&&(e.trafficProtocol=n.trafficProtocol);void 0!==n.trafficServer&&(e.trafficServer=n.trafficServer);void 0!==n.lang&&(e.lang=n.lang);void 0!==n.defaultLang&&(e.tileServerDefaultLang=n.defaultLang);"disableRotation"in n&&(e.disableRotationByUserInteraction=!0);"disablePitch"in n&&(e.disablePitchByUserInteraction=!0);"disableDragging"in n&&(e.disableDragging=!0);"enableTwoFingerDragging"in n&&(e.enableTwoFingerDragging=!0);"keepCenterWhileUserZoomRotate"in n&&(e.keepCenterWhileUserZoomRotate=!0);"styleServer"in n&&(e.styleServer=decodeURIComponent(null!==(o=n.styleServer)&&void 0!==o?o:""));"preserveDrawingBuffer"in n&&(e.preserveDrawingBuffer=!0);"maxPitch"in n&&(e.maxPitch=Number(n.maxPitch));"lowZoomMaxPitch"in n&&(e.lowZoomMaxPitch=Number(n.lowZoomMaxPitch));if("webglVersion"in n){const t=Number(n.webglVersion);1!==t&&2!==t||(e.webglVersion=t)}"modelLayer"in n&&(e.modelLayer=n.modelLayer);"showDefaultTileBounds"in n&&(e.showDefaultTileBounds=!0);"enableHover"in n&&(e.disableHoverStyles=!1);"disableIconCache"in n&&(e.disableIconCache=!0);"demTileSet"in n&&(e.demTileSet=n.demTileSet);"demReliefTileType"in n&&(e.demReliefTileType=n.demReliefTileType);"demElevationSourceType"in n&&(e.demElevationSourceType=n.demElevationSourceType);"graphicsPreset"in n&&(e.graphicsPreset=n.graphicsPreset);"disableModelsGrowthAnimation"in n&&(e.disableModelsGrowthAnimation=!0);e.disableLayerAnimation="disableLayerAnimation"in n,e.useFlatDemIrregularMeshNormals="useFlatDemIrregularMeshNormals"in n,e.mobileSdkMode="mobileSdkMode"in n,e.dem="dem"in n,e.cesiumTiles="cesiumTiles"in n,e.globe="globe"in n,e.styleState={},e.globe&&(e.styleState.globeEnabled=!0);"floorStack"in n&&(e.styleState.floorStackOn=!0);e.satellite="satellite"in n,e.rampPreset=n.rampPreset,e.shading=Number(n.shading),"enableTrackResize"in n&&(e.enableTrackResize=!!n.enableTrackResize);e.debugWideRoads="debugWideRoads"in n,e.immersiveRoads="immersiveRoads"in n,e.immersiveOn="immersiveOn"in n,"loopWorld"in n&&(e.loopWorld="true"===n.loopWorld);e.trafficOn="traffic"in n;if(["trafficMinZoom","trafficMaxZoom","trafficMaxDetailLevel"].forEach((t=>{t in n&&(e[t]=Number(n[t]))})),void 0!==n.m){const t=decodeURIComponent(n.m).split("/"),o=t[0].split(",");e.center=[parseFloat(o[0]),parseFloat(o[1])],e.zoom=parseFloat(t[1]);for(let o=2;o<=4;o+=2){const n=t[o];if(void 0!==n){const i=parseFloat(t[o+1]);"p"===n?e.pitch=i:"r"===n&&(e.rotation=i)}}}e.jmseData=n.jmseData}(Object.assign({},M));function P(){const e={};return location.search.slice(1).split("&").map((e=>e.split("="))).forEach((t=>{e[t[0]]=t[1]})),e}function F(e,t){const o=C(e,M,!0).reduce(((e,t)=>(e[t.key]=t.value,e)),{});return C(e,t).filter((e=>!(e.key in o)||String(e.value)!==o[e.key])).reduce(((e,t,o)=>e+(0===o?"?":"&")+t.key+(void 0!==t.value?"="+t.value:"")),"")}function C(e,t,o=!1){var n;const i=[],a=P();if(void 0!==t.key&&i.push({key:"key",value:t.key}),!o){const t=e.getCenter(),o=e.getZoom(),n=Math.round(e.getRotation()),r=Math.round(e.getPitch()),l=function(e){return Math.ceil((e*Math.LN2+Math.log(256/360/.5))/Math.LN10)}(o),s=e.getStyleZoom();void 0!==a.styleZoom?i.push({key:"styleZoom",value:s.toFixed(11)}):i.push({key:"zoom",value:o.toFixed(3)}),i.push({key:"lng",value:t[0].toFixed(l)},{key:"lat",value:t[1].toFixed(l)}),0!==n&&i.push({key:"rotation",value:n.toString()}),0!==r&&i.push({key:"pitch",value:r.toString()})}t.mobileSdkMode&&i.push({key:"mobileSdkMode"}),t.disableIconCache&&i.push({key:"disableIconCache"}),t.disableAntiAliasing&&i.push({key:"disableAntiAliasing"}),t.disableHoverStyles||i.push({key:"enableHover"}),t.disablePitchByUserInteraction&&i.push({key:"disablePitch"}),t.keepCenterWhileUserZoomRotate&&i.push({key:"keepCenterWhileUserZoomRotate"}),t.disableRotationByUserInteraction&&i.push({key:"disableRotation"}),t.preserveDrawingBuffer&&i.push({key:"preserveDrawingBuffer"}),void 0!==t.style&&i.push({key:"styleId",value:t.style}),void 0!==t.keyUrl&&i.push({key:"keyUrl",value:t.keyUrl}),void 0!==t.dracoDecoderUrl&&i.push({key:"dracoDecoderUrl",value:t.dracoDecoderUrl}),void 0!==t.styleServer&&i.push({key:"styleServer",value:encodeURIComponent(t.styleServer)}),void 0!==t.fontUrl&&i.push({key:"fontUrl",value:encodeURIComponent(t.fontUrl)}),void 0!==t.iconUrl&&i.push({key:"iconUrl",value:encodeURIComponent(t.iconUrl)}),void 0!==t.modelUrl&&i.push({key:"modelUrl",value:encodeURIComponent(t.modelUrl)}),void 0!==t.nearCameraFade&&i.push({key:"nearCameraFade",value:t.nearCameraFade.map((e=>e.toFixed(1).toString())).join(",")}),void 0!==t.tileServer&&t.tileServer&&i.push({key:"tileServer",value:encodeURIComponent(t.tileServer)}),void 0!==t.modelsTilesUrl&&i.push({key:"modelsTilesUrl",value:encodeURIComponent(t.modelsTilesUrl)}),void 0!==t.defaultSourceModelsRootUrl&&i.push({key:"defaultSourceModelsRootUrl",value:encodeURIComponent(t.defaultSourceModelsRootUrl)}),void 0!==t.tileProtocol&&i.push({key:"tileProtocol",value:t.tileProtocol}),void 0!==t.tileSet&&i.push({key:"tileSet",value:t.tileSet}),void 0!==t.commercialPoiRandomSeed&&i.push({key:"comPoiSeed",value:t.commercialPoiRandomSeed.toString()}),t.dem&&i.push({key:"dem"}),t.demTileSet&&i.push({key:"demTileSet",value:t.demTileSet}),t.demReliefTileType&&i.push({key:"demReliefTileType",value:t.demReliefTileType}),t.demElevationSourceType&&i.push({key:"demElevationSourceType",value:t.demElevationSourceType}),!1===t.enableFog&&i.push({key:"fog"}),t.cesiumTiles&&i.push({key:"cesiumTiles"}),t.globe&&i.push({key:"globe"}),t.rampPreset&&i.push({key:"rampPreset",value:t.rampPreset}),t.shading&&i.push({key:"shading",value:String(t.shading)}),t.reliefScale&&i.push({key:"reliefScale",value:String(t.reliefScale)}),t.satellite&&i.push({key:"satellite"}),void 0!==t.lang&&i.push({key:"lang",value:t.lang}),void 0!==t.tileServerDefaultLang&&i.push({key:"defaultLang",value:t.tileServerDefaultLang}),void 0!==t.defaultBackgroundColor&&i.push({key:"defaultBackgroundColor",value:t.defaultBackgroundColor.replace("#","")}),void 0!==t.trafficProtocol&&i.push({key:"trafficProtocol",value:t.trafficProtocol}),void 0!==t.trafficServer&&i.push({key:"trafficServer",value:t.trafficServer}),t.mobileSdkMode&&i.push({key:"mobileSdkMode"}),void 0!==t.commercialTileSet&&i.push({key:"commercialTileSet",value:t.commercialTileSet}),void 0!==t.modelsTileSet&&i.push({key:"modelsTileSet",value:t.modelsTileSet}),void 0!==t.modelLayer&&i.push({key:"modelLayer",value:t.modelLayer}),void 0!==t.maxPitch&&i.push({key:"maxPitch",value:t.maxPitch.toFixed(0)}),t.lowZoomMaxPitch&&i.push({key:"lowZoomMaxPitch",value:t.lowZoomMaxPitch.toString()}),t.showDefaultTileBounds&&i.push({key:"showDefaultTileBounds"}),void 0!==t.webglVersion&&i.push({key:"webglVersion",value:String(t.webglVersion)}),t.debugWideRoads&&i.push({key:"debugWideRoads"}),t.immersiveRoads&&i.push({key:"immersiveRoads"}),t.immersiveOn&&i.push({key:"immersiveOn"}),void 0!==t.loopWorld&&i.push({key:"loopWorld",value:String(t.loopWorld)}),(null===(n=e.getStyleState())||void 0===n?void 0:n.trafficOn)&&i.push({key:"traffic"}),t.graphicsPreset&&i.push({key:"graphicsPreset",value:t.graphicsPreset});return["trafficMinZoom","trafficMaxZoom","trafficMaxDetailLevel"].forEach((e=>{void 0!==t[e]&&i.push({key:e,value:String(t[e])})})),t.useFlatDemIrregularMeshNormals&&i.push({key:"useFlatDemIrregularMeshNormals"}),t.disableModelsGrowthAnimation&&i.push({key:"disableModelsGrowthAnimation"}),t.disableLayerAnimation&&i.push({key:"disableLayerAnimation"}),e.getStyleState().floorStackOn&&i.push({key:"floorStack"}),t.jmseData&&i.push({key:"jmseData",value:String(t.jmseData)}),i}function R(){const e={};return location.search.slice(1).split("&").map((e=>e.split("="))).forEach((t=>{e[t[0]]=t[1]})),e}const T=R(),I=-180,N="en"!==new URL(location.href).searchParams.get("lang")?"ru":"en",E={center:[82.920412,55.030111],zoom:15,key:"a1893935-6834-4445-b97a-3405fb426c5b",enableTrackResize:!0,zoomControl:"centerRight",maxPitch:75,lowZoomMaxPitch:75,webglVersion:2,disableAntiAliasing:!1,lang:N},U=function(e){const t=R();void 0!==t.lng&&void 0!==t.lat&&(e.center=[parseFloat(t.lng),parseFloat(t.lat)]);void 0!==t.zoom&&(e.zoom=parseFloat(t.zoom));void 0!==t.rotation&&(e.rotation=parseFloat(t.rotation));void 0!==t.pitch&&(e.pitch=parseFloat(t.pitch));void 0!==t.styleId&&(e.style=t.styleId);void 0!==t.lang&&(e.lang=t.lang);"graphicsPreset"in t&&(e.graphicsPreset=t.graphicsPreset);if(void 0!==t.m){const o=decodeURIComponent(t.m).split("/"),n=o[0].split(",");e.center=[parseFloat(n[0]),parseFloat(n[1])],e.zoom=parseFloat(o[1]);for(let t=2;t<=4;t+=2){const n=o[t];if(void 0!==n){const i=parseFloat(o[t+1]);"p"===n?e.pitch=i:"r"===n&&(e.rotation=i)}}}return e}(Object.assign({},E)),A=window.map=new mapgl.Map("map",U);A.on("idle",(()=>{let e=F(A,{disableHoverStyles:!0});T.root&&(e+="&root=true"),history.replaceState({},document.title,e)})),"true"===T.root&&function(){var e;const t='<div class="terrainButtonRoot" >\n    <button type="button" class="terrainButton none" onclick>\n       <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="none" viewBox="0 0 32 32"><path fill="currentColor" d="M8 10.143v12.824l5.065-2.17 6 3L24 21.68V8.857l1.303-.558a.5.5 0 01.697.46V23l-7 3-6-3-6.303 2.701a.5.5 0 01-.697-.46V11l2-.857zm12.243 5.1L16 19.485l-4.243-4.242a6 6 0 118.486 0zM16 16.657l2.828-2.829a4 4 0 10-5.656 0L16 16.657z"></path></svg>\n    </button>\n</div>\n',o=new mapgl.Control(A,t,{position:"topRight"});null===(e=o.getContainer().querySelector("button"))||void 0===e||e.addEventListener("click",(()=>{const{terrainEnabled:e}=A.getStyleState();A._impl.modules.demManager.setReliefTileType("vector"),A._impl.modules.demManager.setElevationSourceType("irregular"),A._impl.state.useFlatDemIrregularMeshNormals=!0,A.patchStyleState({terrainEnabled:!e})}))}();document.getElementById("main-wrap").innerHTML=`\n    <div id="bar">\n        <div id="model-add-info">${L.modelLocationInfo[N]}</div>\n        <div id="model-list"></div>\n        \x3c!-- <input\n            id="add-model-input"\n            type="file"\n            accept=".glb,.gltf,.png,.jpg,.jpeg,.bin"\n            multiple\n        /> --\x3e\n        <input id="add-model-input" type="file" accept=".glb" multiple />\n        <label for="add-model-input" id="add-model-label" class="control">\n            <span>${L.addModel[N]}</span>\n            <svg\n                width="24px"\n                height="24px"\n                viewBox="0 0 24 24"\n                fill="none"\n                xmlns="http://www.w3.org/2000/svg"\n            >\n                <path\n                    fill-rule="evenodd"\n                    clip-rule="evenodd"\n                    d="M10.5 10.5H7C6.17157 10.5 5.5 11.1716 5.5 12C5.5 12.8284 6.17157 13.5 7 13.5H10.5V17C10.5 17.8284 11.1716 18.5 12 18.5C12.8284 18.5 13.5 17.8284 13.5 17V13.5H17C17.8284 13.5 18.5 12.8284 18.5 12C18.5 11.1716 17.8284 10.5 17 10.5H13.5V7C13.5 6.17157 12.8284 5.5 12 5.5C11.1716 5.5 10.5 6.17157 10.5 7V10.5ZM24 12C24 18.6274 18.6274 24 12 24C5.37258 24 0 18.6274 0 12C0 5.37258 5.37258 0 12 0C18.6274 0 24 5.37258 24 12Z"\n                    fill="#0075ff"\n                />\n            </svg>\n        </label>\n    </div>\n    <button id="config-button" type="button" class="control">${L.getSceneConfig[N]}</button>\n    <div id="map-controls">\n        <div>\n            <input type="number" id="zoom-value" min="0" max="0" value="0" step="0.01" />\n            <input\n                type="range"\n                id="zoom-range"\n                min="0"\n                max="0"\n                value="0"\n                step="0.01"\n                class="control"\n            />\n            <label for="zoom-range">${L.zoomRange[N]}</label>\n        </div>\n        <div>\n            <input type="number" id="pitch-value" min="0" max="0" value="0" step="0.01" />\n            <input\n                type="range"\n                id="pitch-range"\n                min="0"\n                max="0"\n                value="0"\n                step="0.01"\n                class="control"\n            />\n            <label for="pitch-range">${L.pitchRange[N]}</label>\n        </div>\n        <div>\n            <input\n                type="number"\n                id="rotation-value"\n                min="0"\n                max="0"\n                value="0"\n                step="0.01"\n            />\n            <input\n                type="range"\n                id="rotation-range"\n                min="0"\n                max="0"\n                value="0"\n                step="0.01"\n                class="control"\n            />\n            <label for="rotation-range">${L.rotationRange[N]}</label>\n        </div>\n    </div>`;const Z=document.getElementById("model-add-info"),j=document.getElementById("model-list"),B=document.getElementById("model-params"),z=A._impl.getContainer(),D=new Map;let O,$,q,H="idle";function _(){if(!O)return;const e=D.get(O);if(!e)return;const t=e.linkedIds.join("\n"),o=O.getCoordinates(),n=O.getRotation(),i=O.getScale(),a=O._impl.layer.style.playAnimation,r=B.querySelector("#lng-value");r&&(r.value=o[0].toFixed(6));const l=B.querySelector("#lat-value");l&&(l.value=o[1].toFixed(6));const s=B.querySelector("#linkedids-value");s&&(s.value=t);const d=B.querySelector("#rotate-x-value");d&&(d.value=n[0].toFixed(2));const u=B.querySelector("#rotate-y-value");u&&(u.value=n[1].toFixed(2));const c=B.querySelector("#rotate-z-value");c&&(c.value=n[2].toFixed(2));const m=B.querySelector("#scale-value");m&&(m.value=i[0].toFixed(2));const p=B.querySelector("#playAnimation");p&&(p.value=void 0!==a?a.toString():"-1")}function G(){const e=[];D.forEach((({linkedIds:t})=>e.push(...t))),A.setHiddenObjects(e)}function V(){const e=[];D.forEach((({linkedIds:t})=>e.push(...t))),A.unsetHiddenObjects(e)}!function(){document.getElementById("config-button").addEventListener("click",(()=>e(this,void 0,void 0,(function*(){const e=document.createElement("a"),t=[];for(const[e,{linkedIds:o,name:n}]of D.entries()){const[i,a]=e.getCoordinates(),r=e.getRotation(),l=e.getScale(),s=yield w(`${i}${a}${o.join("")}`),d=n.match(/(.*)\.glb$/);t.push({modelId:`${d?d[1]:n}_${s}`,coordinates:[i,a],modelUrl:n,interactive:!0,rotateX:r[0],rotateY:r[1],rotateZ:r[2],scale:l[0],linkedIds:o,floors:[]})}e.href=URL.createObjectURL(new Blob([JSON.stringify(t)],{type:"application/json"})),e.download="mapgl-gltf-config.json",e.click(),URL.revokeObjectURL(e.href)}))));const t=document.getElementById("add-model-input");t.addEventListener("change",(()=>e(this,void 0,void 0,(function*(){if(!t.files)return;const e=Array.from(t.files),o=new Map;e.forEach((e=>{e.name.match(/\.glb$/)&&o.set(e.name,URL.createObjectURL(e))})),t.value="",Z.style.display="none",o.forEach(((e,t)=>{const o=new mapgl.GltfModel(A,{coordinates:A.getCenter(),modelSrc:e,interactive:!0,disableAnimation:!0,hover:{color:"#0F0"},select:{color:"#00C300"}}),n=function(e,t){const o=document.createElement("div");o.classList.add("model-item"),o.classList.add("control"),o.innerHTML='<span class="loader"></span>';const n=()=>{e.setState({hovered:!0}),o.classList.add("hovered")},i=()=>{e.setState({hovered:!1}),o.classList.remove("hovered")},a=()=>{D.forEach((({html:e},t)=>{t.setState({selected:!1}),e.classList.remove("selected")})),e.setState({selected:!0}),o.classList.add("selected"),O=e;const t=function(e){const t=document.createElement("div"),o=`\n        <div>\n            <h4>${L.modelParamPlayAnimation[N]}</h4>\n            <p>${L.modelParamAnimationInfo[N]}</p>\n            <div class="model-params-item">\n                <label for="playAnimation">${L.modelPlayAnimationIndex[N]}</label>\n                <input type="number" id="playAnimation" min="-1" max="${1/0}" value="-1" step="1" />\n            </div>\n        </div>\n        `;t.innerHTML=`\n        <div>\n            <svg id="close-button" class="control" fill="#000000" width="20px" height="20px" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">\n                <path d="M18.8,16l5.5-5.5c0.8-0.8,0.8-2,0-2.8l0,0C24,7.3,23.5,7,23,7c-0.5,0-1,0.2-1.4,0.6L16,13.2l-5.5-5.5  c-0.8-0.8-2.1-0.8-2.8,0C7.3,8,7,8.5,7,9.1s0.2,1,0.6,1.4l5.5,5.5l-5.5,5.5C7.3,21.9,7,22.4,7,23c0,0.5,0.2,1,0.6,1.4  C8,24.8,8.5,25,9,25c0.5,0,1-0.2,1.4-0.6l5.5-5.5l5.5,5.5c0.8,0.8,2.1,0.8,2.8,0c0.8-0.8,0.8-2.1,0-2.8L18.8,16z"/>\n            </svg>\n            <h4>${L.modelParamCoords[N]}</h4>\n            <p>${L.modelParamCoordsInfo[N]}</p>\n            <div class="model-params-item">\n                <label for="lng-value">${L.modelParamLng[N]}</label>\n                <input type="number" id="lng-value" min="-180" max="180" value="0" step="0.000001" />\n            </div>\n\n            <div class="model-params-item">\n                <label for="lat-value">${L.modelParamLat[N]}</label>\n                <input type="number" id="lat-value" min="-85.06" max="85.06" value="0" step="0.000001" />\n            </div>\n        </div>\n\n        <div>\n            <h4>${L.modelParamLinkedObjects[N]}</h4>\n            <p>${L.modelParamLinkedObjectsInfo[N]}</p>\n            <div class="model-params-item">\n                <label for="linkedids-value">${L.modelParamLinkedIds[N]}</label>\n                <textarea id="linkedids-value"></textarea>\n            </div>\n        </div>\n\n        <div>\n            <h4>${L.modelParamRotation[N]}</h4>\n            <p>${L.modelParamRotationInfo[N]}</p>\n            <div class="model-params-item">\n                <label for="rotate-x-value">X</label>\n                <input type="number" id="rotate-x-value" min="-360" max="360" value="0" step="0.01" />\n            </div>\n            <div class="model-params-item">\n                <label for="rotate-y-value">Y</label>\n                <input type="number" id="rotate-y-value" min="-360" max="360" value="0" step="0.01" />\n            </div>\n            <div class="model-params-item">\n                <label for="rotate-z-value">Z</label>\n                <input type="number" id="rotate-z-value" min="-360" max="360" value="0" step="0.01" />\n            </div>\n        </div>\n\n        <div>\n            <h4>${L.modelParamScale[N]}</h4>\n            <p>${L.modelParamScaleInfo[N]}</p>\n            <div class="model-params-item">\n                <label for="scale-value">X, Y, Z</label>\n                <input type="number" id="scale-value" min="0.01" max="${1/0}" value="0" step="0.01" />\n            </div>\n        </div>\n\n    ${T.root?o:""}\n    `;t.querySelector("#close-button").addEventListener("click",(t=>{t.stopPropagation(),e===O&&(D.forEach((({html:e},t)=>{t.setState({selected:!1}),e.classList.remove("selected")})),B.style.display="none",B.innerHTML="",O=void 0)}));const n=t.querySelector("#lng-value");n.addEventListener("input",(({target:t})=>{const o=parseFloat(t.value);if(Number.isNaN(o))return;n.value=String(o);const i=e.getCoordinates();e.transform([{coordinates:[o,i[1]]}])})),n.addEventListener("change",(({target:e})=>{const t=parseFloat(e.value);Number.isNaN(t)||(n.value=t.toFixed(6),n.blur())}));const i=t.querySelector("#lat-value");i.addEventListener("input",(({target:t})=>{const o=parseFloat(t.value);if(Number.isNaN(o))return;i.value=String(o);const n=e.getCoordinates();e.transform([{coordinates:[n[0],o]}])})),i.addEventListener("change",(({target:e})=>{const t=parseFloat(e.value);Number.isNaN(t)||(i.value=t.toFixed(6),i.blur())}));const a=t.querySelector("#linkedids-value");a.addEventListener("change",(({target:t})=>{const o=D.get(e);if(!o)return;const n=t.value,i=n.length?Array.from(new Set(n.split("\n").filter((e=>e.length)))):[];V(),o.linkedIds=i,G(),a.value=i.join("\n"),a.blur()}));const r=t.querySelector("#rotate-x-value");r.addEventListener("input",(({target:t})=>{let o=parseFloat(t.value);if(Number.isNaN(o))return;o%=360,r.value=String(o);const n=e.getRotation();n[0]=o,e.transform([{rotation:n}])})),r.addEventListener("change",(({target:e})=>{const t=parseFloat(e.value);Number.isNaN(t)||(r.value=t.toFixed(2),r.blur())}));const l=t.querySelector("#rotate-y-value");l.addEventListener("input",(({target:t})=>{let o=parseFloat(t.value);if(Number.isNaN(o))return;o%=360,l.value=String(o);const n=e.getRotation();n[1]=o,e.transform([{rotation:n}])})),l.addEventListener("change",(({target:e})=>{const t=parseFloat(e.value);Number.isNaN(t)||(l.value=t.toFixed(2),l.blur())}));const s=t.querySelector("#rotate-z-value");s.addEventListener("input",(({target:t})=>{let o=parseFloat(t.value);if(Number.isNaN(o))return;o%=360,s.value=String(o);const n=e.getRotation();n[2]=o,e.transform([{rotation:n}])})),s.addEventListener("change",(({target:e})=>{const t=parseFloat(e.value);Number.isNaN(t)||(s.value=t.toFixed(2),s.blur())}));const d=t.querySelector("#scale-value");if(d.addEventListener("input",(({target:t})=>{const o=parseFloat(t.value);Number.isNaN(o)||(d.value=String(o),e.transform([{scale:[o,o,o]}]))})),d.addEventListener("change",(({target:e})=>{const t=parseFloat(e.value);Number.isNaN(t)||(d.value=t.toFixed(2),d.blur())})),T.root){const o=t.querySelector("#playAnimation");o.addEventListener("input",(({target:t})=>{const n=parseInt(t.value,2);Number.isNaN(n)||(o.value=String(n),e._impl.layer.style.playAnimation=n,A.triggerRerender())})),o.addEventListener("change",(({target:e})=>{const t=parseFloat(e.value);Number.isNaN(t)||(o.value=t.toFixed(0),o.blur())}))}return t}(e);B.innerHTML="",B.append(t),_(),B.style.display="block"};return o.addEventListener("mouseover",n),o.addEventListener("mouseout",i),o.addEventListener("click",(()=>{a(),A.setCenter(e.getCoordinates())})),e.on("mouseover",n),e.on("mouseout",i),e.on("click",a),e.on("mousedown",(t=>{if("idle"!==H)return;const o=t.originalEvent;H="capture",$=e,z.classList.add("mapgl-capture"),q=[o.clientX,o.clientY]})),e.on("modelloaded",(()=>{o.innerHTML=`\n            <span>${t}</span>\n            <svg fill="#000000" width="24px" height="24px" viewBox="0 0 56 56" xmlns="http://www.w3.org/2000/svg"><path d="M 15.7566 49.5476 L 40.2434 49.5476 C 44.8420 49.5476 46.8962 47.4001 47.5731 42.8248 L 51.0511 19.4118 L 51.5645 19.4118 C 54.4358 19.4118 56 17.6144 56 14.7665 L 56 11.2183 C 56 8.3705 54.4358 6.5731 51.5645 6.5731 L 4.4352 6.5731 C 1.7040 6.5731 0 8.3705 0 11.2183 L 0 14.7665 C 0 17.6144 1.5640 19.4118 4.4352 19.4118 L 4.9721 19.4118 L 8.4268 42.8248 C 9.1271 47.4234 11.1579 49.5476 15.7566 49.5476 Z M 5.3922 15.8870 C 4.2251 15.8870 3.7582 15.3968 3.7582 14.2296 L 3.7582 11.7553 C 3.7582 10.5881 4.2251 10.0979 5.3922 10.0979 L 50.6308 10.0979 C 51.7983 10.0979 52.2419 10.5881 52.2419 11.7553 L 52.2419 14.2296 C 52.2419 15.3968 51.7983 15.8870 50.6308 15.8870 Z M 15.8032 46.0228 C 13.7024 46.0228 12.5118 45.0891 12.1617 42.7782 L 8.6836 19.4118 L 47.3164 19.4118 L 43.8380 42.7782 C 43.5115 45.0891 42.2743 46.0228 40.1967 46.0228 Z M 21.2188 41.1441 C 21.7090 41.1441 22.1292 40.9107 22.4560 40.5839 L 27.9883 35.0516 L 33.5206 40.5839 C 33.8474 40.8874 34.2676 41.1441 34.7811 41.1441 C 35.7615 41.1441 36.5552 40.3038 36.5552 39.3234 C 36.5552 38.7865 36.3451 38.4130 36.0183 38.0629 L 30.5093 32.5539 L 36.0416 26.9749 C 36.3918 26.6014 36.5785 26.2513 36.5785 25.7611 C 36.5785 24.7573 35.7849 23.9637 34.7811 23.9637 C 34.3376 23.9637 33.9408 24.1504 33.5673 24.5239 L 27.9883 30.0562 L 22.4326 24.5472 C 22.0825 24.1971 21.7090 24.0104 21.2188 24.0104 C 20.2384 24.0104 19.4214 24.7807 19.4214 25.7611 C 19.4214 26.2746 19.6315 26.6715 19.9583 26.9983 L 25.4673 32.5539 L 19.9583 38.0862 C 19.6315 38.4130 19.4214 38.8098 19.4214 39.3234 C 19.4214 40.3038 20.2150 41.1441 21.2188 41.1441 Z"/></svg>\n        `;o.querySelector("svg").addEventListener("click",(t=>{t.stopPropagation();confirm(L.removeModelMsg[N])&&(e.destroy(),j.removeChild(o),e===O&&(B.style.display="none",B.innerHTML=""),j.children.length||(Z.style.display="block"),V(),D.delete(e),G())}))})),j.append(o),o}(o,t);D.set(o,{html:n,name:t,linkedIds:[]})}))}))));const o=document.getElementById("zoom-value"),n=document.getElementById("zoom-range");o.min=A.getMinZoom().toFixed(2),o.max=A.getMaxZoom().toFixed(2),o.value=A.getZoom().toFixed(2),n.min=A.getMinZoom().toFixed(2),n.max=A.getMaxZoom().toFixed(2),n.value=A.getZoom().toFixed(2),o.addEventListener("change",(e=>{const t=e.target;let i=parseFloat(t.value);Number.isNaN(i)||(i=m(i,A.getMinZoom(),A.getMaxZoom()),o.value=i.toFixed(2),n.value=i.toFixed(2),A.setZoom(i))})),n.addEventListener("input",(e=>{const t=e.target,n=parseFloat(t.value);Number.isNaN(n)||(o.value=n.toFixed(2),A.setZoom(n))})),A.on("zoom",(({isUser:e})=>{if(!e)return;const t=Math.round(100*A.getZoom())/100;o.value=t.toFixed(2),n.value=t.toFixed(2)}));const i=document.getElementById("pitch-value"),a=document.getElementById("pitch-range");i.min=(0).toFixed(2),i.max=75..toFixed(2),i.value=A.getPitch().toFixed(2),a.min=(0).toFixed(2),a.max=75..toFixed(2),a.value=A.getPitch().toFixed(2),i.addEventListener("change",(e=>{const t=e.target;let o=parseFloat(t.value);Number.isNaN(o)||(o=m(o,0,75),i.value=o.toFixed(2),a.value=o.toFixed(2),A.setPitch(o))})),a.addEventListener("input",(e=>{const t=e.target,o=parseFloat(t.value);Number.isNaN(o)||(i.value=o.toFixed(2),A.setPitch(o))})),A.on("pitch",(({isUser:e})=>{if(!e)return;const t=Math.round(100*A.getPitch())/100;i.value=t.toFixed(2),a.value=t.toFixed(2)}));const r=document.getElementById("rotation-value"),l=document.getElementById("rotation-range");r.min=I.toFixed(2),r.max=180..toFixed(2),r.value=A.getRotation().toFixed(2),l.min=I.toFixed(2),l.max=180..toFixed(2),l.value=A.getRotation().toFixed(2),r.addEventListener("change",(e=>{const t=e.target;let o=parseFloat(t.value);Number.isNaN(o)||(o=m(o,I,180),r.value=o.toFixed(2),l.value=o.toFixed(2),A.setRotation(o))})),l.addEventListener("input",(e=>{const t=e.target,o=parseFloat(t.value);Number.isNaN(o)||(r.value=o.toFixed(2),A.setRotation(o))})),A.on("rotation",(({isUser:e})=>{if(!e)return;const t=Math.round(100*A.getRotation())/100;r.value=t.toFixed(2),l.value=t.toFixed(2)}))}(),function(){window.addEventListener("beforeunload",(e=>{const t=L.pageLeaveMsg[N];return e.returnValue=t,t})),window.addEventListener("keydown",(({code:e})=>{"Escape"===e&&"idle"===H&&(D.forEach((({html:e},t)=>{t.setState({selected:!1}),e.classList.remove("selected")})),B.style.display="none",B.innerHTML="",O=void 0)}));const e={ArrowUp:[0,1],ArrowDown:[0,-1],ArrowRight:[1,0],ArrowLeft:[-1,0]};let t;window.addEventListener("keydown",(({code:t})=>{if("idle"!==H)return;if(!O)return;if(!Object.keys(e).includes(t))return;if(Boolean(B.querySelectorAll("*:focus").length))return;const o=A.getRotation(),n=function(e,t){return[e[0]*Math.cos(t)-e[1]*Math.sin(t),e[0]*Math.sin(t)+e[1]*Math.cos(t)]}(e[t],p(o)),i=O.getCoordinates(),a=mapgl._J.utils.projectGeoToMap(i),r=.1*y*k.scaleFactor(i[1]);a[0]+=n[0]*r,a[1]+=n[1]*r,O.transform([{coordinates:mapgl._J.utils.projectMapToGeo(a)}]),_()}));const o=e=>{if("scale"===H||"rotation"===H){if(e instanceof KeyboardEvent){if("KeyS"!==e.code&&"KeyR"!==e.code)return;if("rotation"===H&&"KeyS"===e.code)return;if("scale"===H&&"KeyR"===e.code)return}A._impl.modules.handler.unblock(),z.classList.remove("mapgl-scale","mapgl-rotate"),t=void 0,q=void 0,H="idle"}};window.addEventListener("keyup",o),window.addEventListener("mouseleave",o),window.addEventListener("keydown",(({code:e})=>{if("idle"!==H||!O)return;return Boolean(B.querySelectorAll("*:focus").length)||"KeyS"!==e&&"KeyR"!==e?void 0:(A._impl.modules.handler.block(),"KeyS"===e?(z.classList.add("mapgl-scale"),void(H="scale")):"KeyR"===e?(z.classList.add("mapgl-rotate"),void(H="rotation")):void 0)})),window.addEventListener("mousemove",(e=>{if("scale"!==H&&"rotation"!==H)return;if(!O)return;if(1!==e.buttons)return;if(!q||!t)return q=[e.clientX,e.clientY],void(t=O.getScale());const o=[e.clientX,e.clientY],n=A.project(O.getCoordinates()),i=[q[0]-n[0],q[1]-n[1]],a=[o[0]-n[0],o[1]-n[1]],r=x(i),l=x(a);if(r&&l){if("scale"===H){if(!t)return;O.transform([{scale:t.map((e=>Math.max(l*e/r,.01)))}])}else if("rotation"===H){const e=Math.sign((d=a,(s=i)[0]*d[1]-s[1]*d[0])),t=O.getRotation(),n=Math.acos(m(function(e,t){return e[0]*t[0]+e[1]*t[1]}(i.map((e=>e/r)),a.map((e=>e/l))),-1,1));t[2]+=Math.round(-e*v(n)*.5%360*100)/100,O.transform([{rotation:t}]),q=o}var s,d;_()}})),window.addEventListener("mouseup",(({button:e})=>{"scale"!==H&&"rotation"!==H||0===e&&(t=void 0,q=void 0)})),A._impl.on("click",(({target:e})=>{if("idle"!==H||!e||!O)return;const{symbol:t}=e;if("polygonExtrusion"!==t&&"buildingModel"!==t&&"gltfModel"!==t)return;const o=D.get(O);o&&(o.linkedIds.includes(e.id)?A.triggerRerender():(o.linkedIds.push(e.id),G(),_()))}));const n=()=>{"capture"===H&&(A._impl.modules.handler.unblock(),q=void 0,H="idle",$=void 0,z.classList.remove("mapgl-capture"))};window.addEventListener("mouseup",n),window.addEventListener("mouseleave",n),window.addEventListener("mousemove",(e=>{if("capture"!==H||!q||!$)return;A._impl.modules.handler.block();const t=[e.clientX,e.clientY],o=A.project($.getCoordinates()),n=[t[0]-q[0],t[1]-q[1]];$.transform([{coordinates:A.unproject([o[0]+n[0],o[1]+n[1]])}]),q=t,$===O&&_()}))}()})()})();